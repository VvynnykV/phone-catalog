import{r as h}from"./index-C6L-97Tt.js";var E=Object.defineProperty,x=(e,t,n)=>t in e?E(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,g=(e,t,n)=>x(e,typeof t!="symbol"?t+"":t,n),R=new Map,w=new WeakMap,N=0,A;function T(e){return e?(w.has(e)||(N+=1,w.set(e,N.toString())),w.get(e)):"0"}function k(e){return Object.keys(e).sort().filter(t=>e[t]!==void 0).map(t=>`${t}_${t==="root"?T(e.root):e[t]}`).toString()}function B(e){const t=k(e);let n=R.get(t);if(!n){const s=new Map;let d;const r=new IntersectionObserver(o=>{o.forEach(i=>{var u;const l=i.isIntersecting&&d.some(a=>i.intersectionRatio>=a);e.trackVisibility&&typeof i.isVisible>"u"&&(i.isVisible=l),(u=s.get(i.target))==null||u.forEach(a=>{a(l,i)})})},e);d=r.thresholds||(Array.isArray(e.threshold)?e.threshold:[e.threshold||0]),n={id:t,observer:r,elements:s},R.set(t,n)}return n}function S(e,t,n={},s=A){if(typeof window.IntersectionObserver>"u"&&s!==void 0){const u=e.getBoundingClientRect();return t(s,{isIntersecting:s,target:e,intersectionRatio:typeof n.threshold=="number"?n.threshold:0,time:0,boundingClientRect:u,intersectionRect:u,rootBounds:u}),()=>{}}const{id:d,observer:r,elements:o}=B(n),i=o.get(e)||[];return o.has(e)||o.set(e,i),i.push(t),r.observe(e),function(){i.splice(i.indexOf(t),1),i.length===0&&(o.delete(e),r.unobserve(e)),o.size===0&&(r.disconnect(),R.delete(d))}}function D(e){return typeof e.children!="function"}var W=class extends h.Component{constructor(e){super(e),g(this,"node",null),g(this,"_unobserveCb",null),g(this,"lastInView"),g(this,"handleNode",t=>{this.node&&(this.unobserve(),!t&&!this.props.triggerOnce&&!this.props.skip&&(this.setState({inView:!!this.props.initialInView,entry:void 0}),this.lastInView=this.props.initialInView)),this.node=t||null,this.observeNode()}),g(this,"handleChange",(t,n)=>{const s=this.lastInView;this.lastInView=t,!(s===void 0&&!t)&&(t&&this.props.triggerOnce&&this.unobserve(),D(this.props)||this.setState({inView:t,entry:n}),this.props.onChange&&this.props.onChange(t,n))}),this.state={inView:!!e.initialInView,entry:void 0},this.lastInView=e.initialInView}componentDidMount(){this.unobserve(),this.observeNode()}componentDidUpdate(e){(e.rootMargin!==this.props.rootMargin||e.root!==this.props.root||e.threshold!==this.props.threshold||e.skip!==this.props.skip||e.trackVisibility!==this.props.trackVisibility||e.delay!==this.props.delay)&&(this.unobserve(),this.observeNode())}componentWillUnmount(){this.unobserve()}observeNode(){if(!this.node||this.props.skip)return;const{threshold:e,root:t,rootMargin:n,trackVisibility:s,delay:d,fallbackInView:r}=this.props;this.lastInView===void 0&&(this.lastInView=this.props.initialInView),this._unobserveCb=S(this.node,this.handleChange,{threshold:e,root:t,rootMargin:n,trackVisibility:s,delay:d},r)}unobserve(){this._unobserveCb&&(this._unobserveCb(),this._unobserveCb=null)}render(){const{children:e}=this.props;if(typeof e=="function"){const{inView:v,entry:c}=this.state;return e({inView:v,entry:c,ref:this.handleNode})}const{as:t,triggerOnce:n,threshold:s,root:d,rootMargin:r,onChange:o,skip:i,trackVisibility:u,delay:l,initialInView:a,fallbackInView:b,...V}=this.props;return h.createElement(t||"div",{ref:this.handleNode,...V},e)}};function $({threshold:e,delay:t,trackVisibility:n,rootMargin:s,root:d,triggerOnce:r,skip:o,initialInView:i,fallbackInView:u,onChange:l}={}){var a;const[b,V]=h.useState(null),v=h.useRef(l),c=h.useRef(i),[y,m]=h.useState({inView:!!i,entry:void 0});v.current=l,h.useEffect(()=>{if(c.current===void 0&&(c.current=i),o||!b)return;let p;return p=S(b,(I,C)=>{const O=c.current;c.current=I,!(O===void 0&&!I)&&(m({inView:I,entry:C}),v.current&&v.current(I,C),C.isIntersecting&&r&&p&&(p(),p=void 0))},{root:d,rootMargin:s,threshold:e,trackVisibility:n,delay:t},u),()=>{p&&p()}},[Array.isArray(e)?e.toString():e,b,d,s,r,o,n,u,t]);const _=(a=y.entry)==null?void 0:a.target,M=h.useRef(void 0);!b&&_&&!r&&!o&&M.current!==_&&(M.current=_,m({inView:!!i,entry:void 0}),c.current=i);const f=[V,y.inView,y.entry];return f.ref=f[0],f.inView=f[1],f.entry=f[2],f}export{W as I,$ as u};
